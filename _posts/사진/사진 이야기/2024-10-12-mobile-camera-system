---
title: "디지털 사진이 구성되는 과정와 그 원리"

categories: [사진, 사진 이야기]
tags: [사진, 사진 이야기, 카메라, 이미지센서, 렌즈]
start_with_ads: true

toc: true
toc_sticky: true

date: 2024-11-12 00:00:00 +0900
last_modified_at: 2024-11-12 00:00:00 +0900

mermaid: true
math: true
---

## **들어가며**

저는 간간히 사진을 찍습니다. 단순 기록용을 넘어 좀 더 예쁘고 보기 좋은 사진을 위해 이것저것 시도해보고 있죠.

찍다보니 점점 변수 하나하나를 파악하고 통제하고 싶은 욕심이 들기 시작했습니다. 단순히 ISO와 셔터스피드를 조절하는 것을 넘어 좋은 사진을 남길 수 없는 한계가 있을 수 있음을 인식하고, 괜찮은 사진을 남길 수 있는 요건에는 무엇이 있을까 하는 호기심이었습니다.

## **빛을 받아들이는 센서**

카메라는 빛 정보를 기록하는 장치입니다. 공학적으로는 광선을 따라 입사한 광자의 개수를 측정하는 기계죠. 과거에는 필름의 화학 반응을 이용했지만 오늘날 카메라는 전자공학의 힘을 빌려 디지털 방식으로 사진을 찍습니다.

이때 사용하는 하드웨어는 이미지센서입니다. 그중에서도 CMOS(상보형 금속 산화 반도체) 이미지센서를 사용합니다. 이미지센서는 빛을 받아들이는 상부와 신호를 기초 처리하는 하부로 구성되어 있으며, 그중 중요한 상부의 구조는 대략 다음과 같습니다.

```mermaid
block-beta
  columns 3
  block
    columns 1
	m1["마이크로렌즈"]
	c1["R 컬러필터"]
	p1["광다이오드"]
  end
  block
    columns 1
	m2["마이크로렌즈"]
	c2["G 컬러필터"]
	p2["광다이오드"]
  end
  block
    columns 1
	m3["마이크로렌즈"]
	c3["B 컬러필터"]
	p3["광다이오드"]
  end
```

렌즈를 거친 광자는 컬러 필터에 의해 RGB 색의 3요소로 나뉜 후 광다이오드에 의해 전기신호로 변환됩니다. 변환된 전기 신호는 이미지센서가 지원하는 심도에 의해 다르게 세분화되는데, 예를 들어 이미지센서가 12비트의 심도를 지원한다면 RGB 픽셀이 각각 개별적으로 2¹²가지 밝기 정보를 표현함에 따라 한 개의 픽셀은 RGB 모두 합쳐 (2¹²)³개, 즉 68719476736가지 색을 표현하게 됩니다.

변환된 값은 이미지센서의 하부로 전달되어 기초 이미지 처리를 거치고 외부의 ISP로 전달되어 다시한번 본격적인 이미지 후처리를 거치거나 그대로 메모리에 저장됩니다.

### **이미지 노이즈**

일반적인 인식과 달리 사진은 풍경을 정확하게 담을 수 없습니다. 카메라는 노이즈가 발생할 수밖에 없기 떄문이죠. 제조공정의 현실적인 수율상 발생하는 암전류 또는 픽셀별 감도의 편차에 의해 나타나기도 하고, 사진을 찍을 때 픽셀에 무작위로 입사하는 광자량의 차이에 의해 노이즈가 발생하기도 합니다. 전자를 고정 패턴 노이즈(FPN)라고 한다면, 후자는 임시 노이즈(Temporal Noise)라고 합니다.

고정 패턴 노이즈는 한 번 찍혀나온 하드웨어의 특성상 카메라 사용자가 극복하기 어렵지만, 임시 노이즈는 노력을 통해 어느정도 제어할 수 있습니다. 이때 임시 노이즈를 잘 이해하기 좋은 지표는 신호 대 잡음비(SNR)인데요, SNR은 다음과 같이 정의됩니다.

$$
\text{SNR} = \frac{P_{\text{signal}}}{P_{\text{noise}}}
$$

SNR은 신호와 노이즈의 비율을 정리한 값입니다. 낮을 수록 신호 대비 노이즈가 적다는 의미를 가지죠. 이미지센서의 경우 신호가 많아지면 임시 노이즈의 절대량도 많아지지만, 그 비율, 즉 SNR은 점점 감소하기 때문에 신호를 우선적으로 많이 받아들임으로서 노이즈를 줄일 수 있습니다. 예를 들어 광량 자체 또는 노출 시간을 증가시키나 이미지를 여러장 찍어 하나로 합성하는 등의 방법이 있죠.

혹은, 더 큰 이미지센서를 사용할 수도 있습니다. 이 경우 개별 픽셀의 크기가 커지게 되어 광자 입사 시행횟수를 배로 늘리는 효과를 얻을 수 있게 됩니다. 동일 화소에서 센서의 면적이 넓으면 넓을수록 SNR은 낮아지기 때문입니다.

|유형|모델|화소|픽셀 간격|
|---|---|---|
|풀프레임|소니 A7S3|12MP|8.36μm|
|모바일|삼성 갤럭시 S24 울트라 메인 카메라|12MP|2.40µm|

극단적인 예시이지만 상업용 카메라와 스마트폰 카메라를 비교하면 위와 같습니다. 개별 픽셀이 선형으로 약 3.5배 커지게 되면 그 면적은 3.5²배, 즉 약 12배 유리하므로 저조도 조건에서 더 낮은 SNR값을 유도할 수 있어 명확한 결과물를 얻을 수 있습니다. 전문가가가 번거롭더라도 크고 무거운 카메라를 사용하는 이유입니다.

### **ISO, 또는 게인**

사진을 찍을 때는 적정노출을 잡기 위해 ISO와 조리개, 셔터스피드를 조절하게 됩니다. 이때 노출을 $${H}$$, 조리개를 $${K}$$, 셔터스피드를 $$T$$라고 하고 각각의 관계를 식으로 정리하면 대략 다음과 같이 표현됩니다.

$$
H \sim \text{ISO} \times \left(\frac{1}{K}\right)^2 \times T
$$

그중 ISO는 이미지센서의 특성입니다. ISO는 과거 필름카메라로 사진을 찍을 때는 필름의 감도를 의미했으나 지금은 이미지센서의 게인(Gain), 즉 신호 증폭을 의미합니다. 이미지센서의 감도는 본질적으로 개별 픽셀의 면적에 의해 결정되지만 그 값은 정적이기에 감도를 동적으로 조절하기 위해서 게인을 사용합니다. ISO를 높게 설정하면 노이즈 또한 증폭되는 것도 ISO가 본질적으로 게인이기 때문이죠.

좀 더 구체적으로는 ISO가 2배 증가하게 되면 이미지도 두 배 밝아지게 됩니다. 노이즈를 통제하기 위해 노출 시간을 두 배 더 길게 설정한 경우, 같은 노출을 유지하고 싶다면 조리개값이 같다는 조건에서 ISO는 그 절반이 되어야 합니다.

ISO는 DR, 즉 다이나믹 레인지에도 영향을 미칩니다. DR은 이미지센서가 처리하는 최대 신호를 $$L_{\text{max}}$$, 최소 신호를 $$L_{\text{min}}$$라고 할 때 다음과 같이 정의됩니다.

$$
\text{DR} = \log_{2} \left( \frac{L_{\text{max}}}{L_{\text{min}}} \right)
$$

간단히, DR은 최대신호와 최소신호의 비율입니다. 그런데 ISO를 증가시키게 되면 $$L_{\text{max}}$$ 값은 포화 상태에서 고정되어 있으나 $$L_{\text{min}}$$가 증가하기 때문에 DR은 점차 감소하게 됩니다. 일반적으로 ISO를 조금만 올려도 사진 보기가 불편해질 정도로 큰 영향을 끼치거나 하지는 않지만, 이 또한 ISO를 가급적이면 낮게 설정해야 하는 이유가 됩니다.

{% comment %}
- baseISO에 대한 설명
{% endcomment %}

## **빛을 모으는 렌즈**

이미지센서가 빛을 받아들인다면 렌즈는 빛을 센서가 잘 받아들일 수 있도록 모으는 역할을 합니다.

### **초점거리와 화각**

- 화각과 연관된 설명

### **조리개(F-number)**

> f/8 and be there.

조리개값 계산식은 다음과 같습니다.

$$
f\text{-stop} = \frac{f}{D}
$$

$$f$$는 초점 거리, $$D$$는 직경입니다.

구경이 $$\sqrt{2}$$배 될 때마다 빛이 입사하는 면적은 2배가 되며, 이 간격을 스탑(stop)이라고 합니다.

1.0 - 1.4 - 2.0 - 2.8 - 4.0 - 5.6 - 8.0 - 11 - 16 - 22 - 32 - 45 - 64

전통적인 사진 촬영과 달리 SPC에서는 조리개(f-number)를 조절하기 위해 조리개를 사용하지 않습니다. 이는 해상도 손실로 이어지기 때문입니다(섹션 4.3 참조).

## **이미지 신호 후처리**

- 디모자이크 (Bayer 패턴)
- 그렇게 만들어진 RAW, 라이트룸 보정

---

## **참고**

- [Smartphone imaging technology and its applications](https://www.degruyter.com/document/doi/10.1515/aot-2021-0023/html)
- https://meeco.kr/mini/36205366
- https://blog.naver.com/intrados/221588871606

{% comment %}
요 근래 스마트폰 카메라는 카메라라고 부르기 부끄럽지 않을 정도로 많이 상향평준화됐습니다. 사진을 주로 찍는다면 상업용 전문 카메라를 구할 필요 없이 스마트폰으로도 충분할 정도죠. 하드웨어는 더 크고 우람해졌고, 소프트웨어는 부족함 없이 카메라의 거의 모든 기능을 지원합니다.

특히 저는 [이런저런 사진]()을 찍기 시작하면서 스마트폰을 작은 디지털 카메라로 느끼게 되었고, 그 성능과 한계에 주목하게 되었습니다. 구체적으로 사진이 찍히는 원리와 과정이 궁금해 호기심에 찾아본 여러 문서의 내용을 정리했습니다.
{% endcomment %}
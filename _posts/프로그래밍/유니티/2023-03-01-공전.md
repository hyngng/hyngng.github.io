---
title:  "유니티 | 각도값 입력받아 물체 공전"

categories: [프로그래밍, 유니티]
tags: [프로그래밍, 유니티]

toc: true
toc_sticky: true
 
date: 2023-03-01
last_modified_at: 2023-03-01
---

<br>

유니티는 공전을 위한 함수 `RotateAround()` 를 지원하지만 매개변수로 속력값을 받는데, 때문에 행성처럼 끝없이 이어지는 공전을 구현하고 싶은 것이 아니라면 사용하기에 불편함이 있지만, 대안으로 고등학교 수학을 사용해 `(cosθ*r, sinθ*r)`의 형식으로 좌표를 구할 수 있다.

<br>

```cs
    /*
    stickPos  : 조이스틱의 '스틱'
    centerPos : 조이스틱의 '중심'
    targetPos : 피공전 오브젝트가 위치해야 하는 좌표값
    */

    float mustFollowAngle = GetAngle(stickPos, centerPos);
    targetPos = centerPos + new Vector3(Mathf.Cos(mustFollowAngle * Mathf.Deg2Rad), Mathf.Sin(mustFollowAngle * Mathf.Deg2Rad), 0);

    transform.position = Vector3.Lerp(transform.position, targetPos, 20 * Time.deltaTime);

    // 두 벡터 사이 각도 구하기
    float GetAngle(Vector2 start, Vector2 end)
    {
        Vector2 v2 = end - start;
        return Mathf.Atan2(v2.y, v2.x) * Mathf.Rad2Deg;
    }
```

<br>

![Orbit](https://user-images.githubusercontent.com/96360829/222128251-5c8bf082-a203-4632-b1dd-9e8660ee6766.gif)

<br>

각도값 θ와 길이 r가 주어졌을 때, `(cosθ*r, sinθ*r)`을 C# 코드로 변환하면 위의 8번째 줄과 같이 `(Mathf.Cos(mustFollowAngle * Mathf.Deg2Rad), Mathf.Sin(mustFollowAngle * Mathf.Deg2Rad)` 꼴이 되며, 피공전 오브젝트에 위 스크립트를 적용하면 유연하게 공전시킬 수 있다. 위의 경우, 큐브 양쪽에 배치한 무기 스틱에 스크립트를 적용했으므로 두 개의 무기 스틱이 큐브를 공전한다.